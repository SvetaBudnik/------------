# Методы устойчивого оценивания параметра сдвига распределений непрерывных случайных величин

**ВСЁ АКТУАЛЬНОЕ [ПО ССЫЛКЕ!!!](https://drive.google.com/file/d/1xlpupjlTiXtqIkL17IcSUHNizv0eozZp/view?usp=sharing)**

## Вариант 10.В

Обобщенное распределение Лапласа со следующим значением параметра $n=4$.

$$
f(x,n) = f(x,4) = \frac{e^{-|x|}}{(n-1)!\cdot 16} \sum\limits_{j=0}^{3}\frac{(3+j)!}{(3-j)!\cdot j!} \frac{|x|^{3-j}}{2^{j}} = 
$$

$$
= e^{-|x|}\cdot\frac{|x|^{3}+6|x|^{2} + 15|x| + 15}{96}.
$$

Дисперсия: $\sigma^{2}= 8$,

Коэффициент эксцесса: $\large\gamma_{2} = \frac{3}{4}$. 

## 1.1. Генерация данных

!!!info Полное задание пункта
    Разработать программу, которая реализует генерацию наборов данных с заданным в варианте *чистым распределением и засоренным распределением*, использовать засоряющие распределения, совпадающие с чистым с точностью до значений параметров сдвига и масштаба.

### Генерация чистого распределения

Обобщённое распределение Лапласа с параметром $n=4$ задаётся следующим образом:

$$
f(x) = e^{-|x|}\cdot\frac{|x|^{3}+6|x|^{2} + 15|x| + 15}{16}.
$$

Дисперсия при этом равна $\sigma^{2}=8$, коэффициент эксцесса: $\large\gamma_{2}=\frac{3}{4}$.

Моделирование случайных величин осуществляется по следующей формуле:

$$
x = \ln\left(\frac{\prod\limits_{i:r_{i} \leqslant \frac{1}{2}} 2r_{i}}{\prod\limits_{i: r_{i} > \frac{1}{2}}2(1-r_{i})}\right),
$$

где $r_{i}, i=\{1, \dots, n\}= \{1,2,3,4\}$ – *реализация случайной величины*, равномерно распределённой на интервале $(0; 1)$ (просто 4 значения с генератора равномерных случайных чисел); если нет ни одного элемента, удовлетворяющего условию в произведении, то оно равно 1.

### Генерация засоряющего распределения

Засоряющее распределение должно (судя по всему) повторять исходное распределение, но также должно иметь возможность изменять свой масштаб и сдвиг.  Сдвиг-масштабное преобразование осуществляется по следующей формуле:

$$
x = \theta + \lambda x_{1},
$$

где $\theta$ – параметр сдвига, $\lambda$ – параметр масштаба, $x_{1}$ – значение случайной величины с нулевым сдвигом и единичным масштабом. 

Применимо к формуле нашего распределения, получаем:

$$
x = \theta + \lambda \ln\left(\frac{\prod\limits_{i:r_{i} \leqslant \frac{1}{2}} 2r_{i}}{\prod\limits_{i: r_{i} > \frac{1}{2}}2(1-r_{i})}\right).
$$

### Генерация засорённого распределения

Засорённое распределение представляет собой смесь двух распределений с плотностью, задаваемой следующей формулой:

$$
g(x) = (1 - \varepsilon) f(x) + \varepsilon h(x),
$$

где $0 < \varepsilon < 0.5$ – уровень засорения, $f(x), h(x)$ – плотности чистого и засоряющего распределений соответственно.

Моделирование случайной величины с засорённым распределением можно проводить по следующему алгоритму:

1. Сгенерировать случайное число $r$, равномерно распределённое на интервале $(0; 1)$. Если $r \leqslant 1 - \varepsilon$, перейти на шаг 2, иначе перейти на шаг 3.
2. Сгенерировать случайное число с плотностью $f(x)$ (чистое распределение). Оно и будет искомым числом.
3. Сгенерировать случайное число с плотностью $h(x)$ (загрязняющее распределение). Оно и будет искомым числом.

Для вычисления всяких там параметров полученного засорённого распределения можно воспользоваться следующими формулами. Обозначим $M_{i}, D_{i}, \gamma_{2i}, i=1,2$ мат ожидание, дисперсию и коэффициент эксцесса, соответствующие при $i=1$ и $i=2$ плотностям $f(x)$ и $h(x)$. Тогда матожидание, дисперсия, коэффициенты асимметрии и эксцесса случайной величины с засорённым распределением выражается формулами:

$$
M = (1-\varepsilon)M_{1} + \varepsilon M_{2},
$$

$$
D = (1 - \varepsilon)(M_{1}^{2} + D_{1}) + \varepsilon(M_{2}^{2} + D_{2}) - M^{2},
$$

$$
\gamma_{1} = \frac{1}{D^{1.5}} \left[(1 - \varepsilon) \left\{(M_{1} - M)^{3} + 3(M_{1} - M)D_{1}\right\} + \varepsilon \left\{(M_{2}-M)^{3} + 3(M_{2}-M)D_{2} \right\} \right],
$$

$$
\gamma_{2} = \frac{1}{D^{2}} \left\{ (1-\varepsilon) \left[ (M_{1} - M)^{4} + 6(M_{1} - M)^{2}D_{1} + D_{1}^{2}(\gamma_{21} + 3) \right] + \ \right.
$$

$$
\ + \left. \varepsilon [(M_{2}-M)^{4} +6(M_{2}-M)^{2}D_{2} + D_{2}^{2}(\gamma_{22} + 3) ] \right\} - 3.
$$


